

# Rogue Gnome Identity Provider


## Direct link: [https://2025.holidayhackchallenge.com/badge?section=objective&id=objRogueGnome](https://2025.holidayhackchallenge.com/badge?section=objective&id=objRogueGnome)

## Objective

"As a pentester, I proper love a good privilege escalation challenge, and that's exactly what we've got here. <br>

I've got access to a Gnome's Diagnostic Interface at gnome-48371.atnascorp with the creds <span style="color: green;"> gnome:SittingOnAShelf </span>, but it's just a low-privilege account.<br>

The gnomes are getting some dodgy updates, and I need admin access to see what's actually going on.<br>

Ready to help me find a way to bump up our access level, yeah?"


## Hints

    It looks like the JWT uses JWKS. Maybe a JWKS spoofing attack would work.

    https://github.com/ticarpi/jwt_tool/wiki and https://portswigger.net/web-security/jwt have some great information on analyzing JWT's and performing JWT attacks.

    If you need to host any files for the attack, the server is running a webserver available locally at http://paulweb.neighborhood/ . The files for the site are stored in ~/www

## Solution

First read the notes file:

![Notes file png](obj5images/notes.png)

What I didn't realize (and what became obvious in hindsight) is that the notes file tells you all the tasks you need to do in order.

The next thing we want to do is go to the IDP login page and login as low level user:

![load the Identity Provider login page png](obj5images/load the Identity Provider login page.png)

Now let's login as the <i>Gnome</i> user account with the password <i>SittingOnAShelf</i>

![login to the Identity Provider png](obj5images/login to the Identity Provider.png)

Copy the token and let's load it at the URL jwt.io to see what's inside:

![copying the token](obj5images/CopyingTheToken.png)

![loaded token to JWT.IO](obj5images/JWT.png)

At JWT.IO at the top left, click on the JWT Encoder tab.  Let's update a few items.

First, let's change the JSON web key URL (JKU) to http://paulweb.neighborhood/ <br>
Second, let's change the subject (sub) to admin.<br>
Third, let's change the admin field to "true"
![Spoofing a token](obj5images/JWT Header & Payload.png)

Last let's get a public private key pair from the URL https://jwkset.com/generate and put the private key in so that we have everything needed to generate our token.
![generating a key pair](obj5images/Generate Key Pair.png)

Paste the generated private key into the private key field at JWT.IO. <BR>

We'll return in a bit and to use the new JSON Web Token (JWT) we created.  We need to do one more thing before that... Let's go to the website http//paulweb.neighborhood and place our public key there in a file called jwks.json. <br>

![Curl to PaulWeb](obj5images/Curl to PaulWeb.png)
![Navigating directory & launching Nano](obj5images/Creating the JWK.JSON file.png)
![Using Nano to save the public key in jwks.json](obj5images/Using Nano to save the public key in jwks.json.png)
